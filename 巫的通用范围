-- 最终稳定版 + 启动语音提示（机械音）
-- 欢迎使用巫的最强半通用范围
-- 小条右上角 + ≡ 展开左侧大菜单（透明融合、美观、无方框）
-- 两个UI都可拖动 + 实时跟随 + 防崩

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local StarterGui = game:GetService("StarterGui")

local lp = Players.LocalPlayer

local size = 12
local trans = 0.4

-- 启动语音提示（机械音）
StarterGui:SetCore("SendNotification", {
    Title = "巫的最强半通用范围",
    Text = "欢迎使用\n已加载完成",
    Duration = 6
})

-- hitbox 核心（防卡地）
local last = 0
RunService.Heartbeat:Connect(function()
    if tick() - last > 0.1 then
        last = tick()
        for _, p in Players:GetPlayers() do
            if p ~= lp and p.Character and p.Character:FindFirstChild("Head") then
                local h = p.Character.Head
                local safeSize = math.min(size, 20)
                h.Size = Vector3.new(safeSize, safeSize, safeSize)
                h.Transparency = trans
                h.BrickColor = BrickColor.new("Lime green")
                h.Material = Enum.Material.Neon
                h.CanCollide = false
                h.Massless = true
            end
        end
    end
end)

task.wait(3)

local sg = Instance.new("ScreenGui")
sg.Parent = lp:WaitForChild("PlayerGui")
sg.IgnoreGuiInset = true
sg.DisplayOrder = 10

-- 小条（右上角，可拖动）
local bar = Instance.new("Frame")
bar.Size = UDim2.new(0, 160, 0, 50)
bar.Position = UDim2.new(1, -180, 0, 40)
bar.BackgroundColor3 = Color3.new(1,1,1)
bar.BorderSizePixel = 0
bar.Active = true
bar.Draggable = true
bar.Parent = sg

local barGrad = Instance.new("UIGradient", bar)
barGrad.Color = ColorSequence.new{
    ColorSequenceKeypoint.new(0, Color3.fromRGB(140, 100, 255)),
    ColorSequenceKeypoint.new(1, Color3.fromRGB(20, 20, 30))
}
barGrad.Rotation = 45

local barCorner = Instance.new("UICorner", bar)
barCorner.CornerRadius = UDim.new(0, 18)

local status = Instance.new("TextLabel", bar)
status.Size = UDim2.new(0.7, 0, 1, 0)
status.BackgroundTransparency = 1
status.Text = "大小: " .. size .. " | 透: " .. trans
status.TextColor3 = Color3.new(1,1,1)
status.TextTransparency = 0.15
status.TextSize = 18
status.Font = Enum.Font.GothamBold
status.TextXAlignment = Enum.TextXAlignment.Left
status.Parent = bar

local toggleBtn = Instance.new("TextButton", bar)
toggleBtn.Size = UDim2.new(0, 40, 0, 40)
toggleBtn.Position = UDim2.new(1, -45, 0.5, -20)
toggleBtn.BackgroundTransparency = 1
toggleBtn.Text = "≡"
toggleBtn.TextColor3 = Color3.new(1,1,1)
toggleBtn.TextTransparency = 0.15
toggleBtn.TextSize = 30
toggleBtn.Font = Enum.Font.GothamBold
toggleBtn.Parent = bar

-- 大菜单面板（左侧紧贴，可拖动）
local menu = Instance.new("Frame")
menu.Size = UDim2.new(0, 240, 0, 240)
menu.BackgroundColor3 = Color3.new(1,1,1)
menu.BorderSizePixel = 0
menu.Visible = false
menu.Active = true
menu.Draggable = true
menu.Parent = sg

local menuGrad = Instance.new("UIGradient", menu)
menuGrad.Color = ColorSequence.new{
    ColorSequenceKeypoint.new(0, Color3.fromRGB(140, 100, 255)),
    ColorSequenceKeypoint.new(1, Color3.fromRGB(20, 20, 30))
}
menuGrad.Rotation = 45

local menuCorner = Instance.new("UICorner", menu)
menuCorner.CornerRadius = UDim.new(0, 24)

local menuTitle = Instance.new("TextLabel", menu)
menuTitle.Size = UDim2.new(1, 0, 0, 50)
menuTitle.BackgroundTransparency = 1
menuTitle.Text = "Hitbox 设置"
menuTitle.TextColor3 = Color3.new(1,1,1)
menuTitle.TextTransparency = 0.15
menuTitle.TextSize = 28
menuTitle.Font = Enum.Font.GothamBold
menuTitle.Parent = menu

local sizeIn = Instance.new("TextBox", menu)
sizeIn.Size = UDim2.new(0.8, 0, 0, 50)
sizeIn.Position = UDim2.new(0.1, 0, 0.22, 0)
sizeIn.BackgroundTransparency = 1
sizeIn.TextColor3 = Color3.new(1,1,1)
sizeIn.TextTransparency = 0.1
sizeIn.PlaceholderText = "大小 (1~20)"
sizeIn.Text = tostring(size)
sizeIn.TextSize = 28
sizeIn.Font = Enum.Font.Gotham
sizeIn.ClearTextOnFocus = false
sizeIn.PlaceholderColor3 = Color3.fromRGB(180, 180, 255)
sizeIn.Parent = menu

local transIn = Instance.new("TextBox", menu)
transIn.Size = UDim2.new(0.8, 0, 0, 50)
transIn.Position = UDim2.new(0.1, 0, 0.45, 0)
transIn.BackgroundTransparency = 1
transIn.TextColor3 = Color3.new(1,1,1)
transIn.TextTransparency = 0.1
transIn.PlaceholderText = "透明 (0.3~1)"
transIn.Text = tostring(trans)
transIn.TextSize = 28
transIn.Font = Enum.Font.Gotham
transIn.ClearTextOnFocus = false
transIn.PlaceholderColor3 = Color3.fromRGB(180, 180, 255)
transIn.Parent = menu

local confirm = Instance.new("TextButton", menu)
confirm.Size = UDim2.new(0.8, 0, 0, 60)
confirm.Position = UDim2.new(0.1, 0, 0.7, 0)
confirm.BackgroundTransparency = 1
confirm.Text = "确认修改"
confirm.TextColor3 = Color3.new(1,1,1)
confirm.TextTransparency = 0
confirm.TextSize = 32
confirm.Font = Enum.Font.GothamBold
confirm.Parent = menu

local confirmBorder = Instance.new("UIStroke", confirm)
confirmBorder.Color = Color3.fromRGB(160, 120, 255)
confirmBorder.Thickness = 1.5
confirmBorder.Transparency = 0.3

confirm.MouseButton1Click:Connect(function()
    local ns = tonumber(sizeIn.Text)
    if ns and ns >= 1 and ns <= 20 then size = ns end

    local nt = tonumber(transIn.Text)
    if nt and nt >= 0.3 and nt <= 1 then trans = nt end

    status.Text = "大小: " .. size .. " | 透: " .. trans
    StarterGui:SetCore("SendNotification", {Title = "已更新", Text = "大小 "..size.." | 透 "..trans, Duration = 3})
end)

-- 展开/收起（左侧紧贴，无动画）
local expanded = false
local function toggle()
    expanded = not expanded
    if expanded then
        toggleBtn.Text = "−"
        menu.Position = UDim2.new(1, -440, 0, 40)  -- 紧贴小条左边
        menu.Visible = true
    else
        toggleBtn.Text = "≡"
        menu.Visible = false
    end
end

toggleBtn.Activated:Connect(toggle)
toggleBtn.MouseButton1Click:Connect(toggle)
toggleBtn.TouchTap:Connect(toggle)

StarterGui:SetCore("SendNotification", {
    Title = "最终稳定版",
    Text = "点 ≡ 展开左侧大菜单\n透明融合 + 可拖动\n输入数值 → 点确认",
    Duration = 8
})
